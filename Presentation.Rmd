---
title: "Urban Terror"
author: 'Lukas Bretzinger, Cameron Reed, Sascha Schuster'
date: "Thursday, December 04, 2014"
output: 
  ioslides_presentation:
    logo: logo.png
bibliography: UTBiblio.bib
---

## Origins

<div class="centered">
![@Kilcullen2013](http://ecx.images-amazon.com/images/I/519z2RHlGQL.jpg)
![@Cutter2003](http://img2.imagesbn.com/p/9780415946421_p0_v1_s260x420.jpg)
</div>

## Research Question {.flexbox .vcenter}


<div class="centered">
### **Do Terrorists target urban environments more now than in past days?**
</div>

# Data Collection

## Main Database | ![@START2013](http://www.start.umd.edu/gtd/images/logo-gtd.gif)


> - [Open Source Database](http://www.start.umd.edu/gtd/) run by University of Maryland
> - Over 120k observations on over 120 variables between 1970 and 2013
> - Lots of missing information
> - Poor data quality

-----

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Load basic R packages
library(foreign)
library(car)
library(ggplot2)
library(RCurl)

#download a limited GTD we created for this assignment (5MB instead of 100MB file)
GTD_in_Memory <- getURL("https://rawgit.com/SaschaSchuster/CSSDA_Assignment2_UrbanTerror/master/GTD.csv", ssl.verifypeer=0L, followlocation=1L)
writeLines(GTD_in_Memory,'GTD.csv')

#Load the Global Terrorism Database
rawGTD <- read.csv("GTD.csv", header=TRUE)

#The Global Terror Database (GTD) we are using for our analysis contains over a 120k observations on more than 120 variables.
#The complete database contains redundant or dispensable data for our analysis.
#We therefore filter the database to make it fit our needs. We erase over a 100 variables.
#We only want to look at successfull terror attacks and include basic data on time, location and target.

GTD <- subset(rawGTD, select = c(eventid, iyear, imonth, iday, country, region, attacktype1, targtype1, targsubtype1, propextent, nkill, nwound),iyear >= 1970, na.strings = c("", " "))

### We introduce our first scale: "Targets Urbanity Potential Scale (TUPscale)"
GTD["TUPscale"] <- GTD$targsubtype1
GTD$TUPscale <- recode(GTD$TUPscale, "40:42 = 3; 9 = 1; 27:35 = 1; 37:39 = 1; 65 = 1; 72 = 1; 1 = 2; 4:5 = 2; 10 = 2; 12 = 2; 53:56 = 2; 58:59 = 2; 61:62 = 2; 82 = 2; 95:96 = 2;6 = 3; 13 = 3; 104:108 = 3; 51:52 = 3; 57 = 3; 60 = 3; 63:64 = 3; 73 = 3; 80:81 = 3; 88:92 = 3; 98 = 3; 2 = 4; 3 = 4; 7:8 = 4; 44 = 4; 48:50 = 4; 67:71 = 4; 74:79 = 4; 83:87 = 4; 97 = 4; 99 = 4; 14:26 = 5; 100:103 = 5; 111 = 5; 109 = 5; 110 = 5; 36 = 5; 43 = 5; 45:47 = 5; 66 = 5; 93:94 = 5; 11 = 5", as.numeric.result=TRUE)

### We introduce our second scale: "Extent of Property Damage (PROPscale)"
GTD["PROPscale"] <- GTD$propextent
GTD$PROPscale <- as.numeric(GTD$PROPscale)

### We introduce our third scale: "Extent of Human Damage (HUMscale)" which adds wounded and killed
GTD["HUMscale"] <- GTD$nkill+GTD$nwound
GTD$HUMscale <- as.numeric(GTD$HUMscale)

# We start preparing our first two scales for plotting, recode to rather self explanatory values 
PROPforPlot <- recode(GTD$PROPscale, "1= '> Billion $'; 2= '> Million $'; 3='< Million $'; 4='no economic damage'; NA=NA; 0=NA")
TUPforPlot <- recode(GTD$TUPscale, "1 = '0 - Military and Farmland'; 2 = '2 - Local Governanceand Police'; 3 = '5 - Potentially Urban Workplace'; 4 = '7 - Potentially Urban Infrastructure'; 5 = '9 - Potentially Expressions of Urban Life'", as.numeric.result=FALSE)

#prepare a data frame for plotting
Plotframe <- data.frame(year=GTD$iyear, TUP=TUPforPlot, PROP=PROPforPlot, HUM=GTD$HUMscale)

#as we want to get a sense if different collection issues merged in the GTD, we will split plots with
# horizontal lines that indicate an transition on collecting entity (PIGS, CETIS, ISVG, START)
# adding another layer with text in the plot never worked out, but we kept 'events' in the data frame
intersepz=data.frame(date=as.numeric(c("27", "38", "41")), date2=as.numeric(c("1997", "2009", "2011")), event=c("PGIS Data Collection End", "CETIS Data Collection End", "ISVG Data Collection End"))
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, comment=FALSE}
# the second plot shows the count of attack in different categories of economic damage
PlotPROP <- qplot(factor(year), data=Plotframe, geom = "freqpoly", color = PROP, group = PROP, ylab= NULL, xlab= NULL,
) + geom_vline(data=intersepz, mapping=aes(xintercept=date))
PlotPROP + theme(axis.text.x = element_text(angle = 90), complete = TRUE)
```
Table 1. Attacks per Year (indicating transition of collectors:
PIGS - 1997, CETIS - 2008, ISVG - 2011, START since 2011


## Additional Databases

> * Country level data
    + [World Development Indicators](http://data.worldbank.org/data-catalog/world-development-indicators)

> * City level data
    + [world.cities2009](http://CRAN.R-project.org/package=maps) 
    + [World Cities2013](http://download.maxmind.com/download/geoip/database/LICENSE_WC.txt) 
    + [Urban Centers](http://en.wikipedia.org/wiki/List_of_urban_areas_by_population)
> * Control Variables
    + [Correlates of War](http://www.correlatesofwar.org/)

# Data Cleaning

## Issues

  * Consistency
  * Quality
  * Bias

## Hand Coding

`````
X <- as.character(X)
X <- gsub("\\,","",X)
X <- gsub("\\-","",X)
X <- gsub("\\-","",X)
X <- gsub("\\-","",X)
X <- gsub("\\'","",X)
X <- gsub("\\'","",X)
X <- gsub("\\.","",X)
X <- gsub("\\\\", "", X)
X <- gsub("\\(","",X)
X <- gsub("\\)","",X)
X<-gsub(" ","",X)
X <- tolower(X)
`````

## Hand Coding

* Adjusting City and Country Names
* "Reassigning" Cities to Countries

# Data Manipulating

## Filling In

* Geo Referencing

## New Information

* Coastal Megacities
* Relative City Size
* Cities' Rank Size

## Extrapolation

* Population in the past

# Data Analysis

## Approach

## test leftover



  +---------------+---------------+--------------------+
  | Country       | City          | Target             |
  +===============+===============+====================+
  | Population    | world         | Intra-State        |
  |               | cities        | War                |
  +---------------+---------------+--------------------+
  | Governance    | Urban         | Inter-State War    |
  |               | Centers       |                    |
  +---------------+---------------+--------------------+
    Target Type
    Human Damage
    Property Damage
    


## References