---
title: "Urban Terror"
author: 'Lukas Bretzinger, Cameron Reed, Sascha Schuster'
date: "Thursday, December 04, 2014"
output: 
  ioslides_presentation:
    logo: logo.png
bibliography: UTBiblio.bib
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
PreGTD <- read.csv("TerrorData/Pregtd.csv")
source("0 - Loading Packages.R")

```
## Origins

<div class="centered">
![@Kilcullen2013](http://ecx.images-amazon.com/images/I/519z2RHlGQL.jpg)
![@Cutter2003](http://img2.imagesbn.com/p/9780415946421_p0_v1_s260x420.jpg)
</div>

## Research Question
<br>
<br>
<br>
<br>
**Do terrorists target urban environments more now than in past days?**
<br>
<br>
<br>
<br>
Purely descriptive analysis of a change of time in terrorists targeting behavior


# Data Collection

## Main Database | ![@START2013](http://www.start.umd.edu/gtd/images/logo-gtd.gif)

> * [Open Source Database](http://www.start.umd.edu/gtd/) run by University of Maryland
> * contains more than 120,000 observations on over 120 variables between 1970 and 2013
> * detailed description of target and effect of attack
    - target & weapon,
    - human & property damage
    - perpetrator

<br>
<br>
  The GTD is a powerful database!

-----

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=9}
PreGTD2 <- PreGTD
levels(PreGTD2$region_txt) <- c("Oceania", "Central America", "Central Asia",
                                   "East Asia", "Eastern Europe", "MENA", "North America", "Russia", "South America",
                                   "South Asia", "Southeast Asia", "Sub-Saharan Africa", "Western Europe")
pregtd.alltest <- subset(PreGTD2, select=(c(iyear, region_txt, GTD.city)))
pregtd.alltest <- data.frame(Year=pregtd.alltest$iyear, Region=pregtd.alltest$region_txt, city=pregtd.alltest$GTD.city)
qplot(factor(Year), data=pregtd.alltest, geom = "freqpoly", color = Region, group= Region, xlab="Year", ylab="No. of Attacks") + theme(axis.text.x = element_text(angle = 90), complete = TRUE)
```
**Figure 1:** attacks per year in all world regions

-----

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=9}
# Preparing the intersections where collecting agencies changed 
intersepz <- data.frame(date=as.numeric(c("27", "38", "41")), 
                       date2=as.numeric(c("1997", "2009", "2011")), 
                       event=c("PGIS Data Collection End", "CETIS Data Collection End", "ISVG Data Collection End"))

qplot(factor(Year), data=pregtd.alltest, geom = "freqpoly", color = Region, group= Region, xlab="Year", ylab="No. of Attacks") + theme(axis.text.x = element_text(angle = 90), complete = TRUE) + geom_vline(data=intersepz, mapping=aes(xintercept=date))

```
**Figure 2:** attacks per year in all world regions, indicating transition of collectors: 
 PGIS - 1997, CETIS - 2008, ISVG - 2011, START since 2011
 
## Main Database | ![@START2013](http://www.start.umd.edu/gtd/images/logo-gtd.gif)

      
> * improvable data quality
> * a lot of information is missing
<br>
<br>
<br>
<br>
> The GTD is not providing enough information to answer our research question

## Main Database | ![@START2013](http://www.start.umd.edu/gtd/images/logo-gtd.gif)

 * Target's potential urbanity is provided
 * Environment's is not 
      * Location (suburb? center?)
      * Importance (capital? stronghold?)
      * ``Urbanity`` 
      
      
-----

```{r, echo=FALSE, warning=FALSE, results='asis', message=FALSE, fig.height=6, fig.width=8}

#subset the database
srilankamap <- subset(PreGTD, country_txt=="srilanka" & !is.na(latitude))
srilankamap <- srilankamap[!duplicated(srilankamap$merge),]

qmap('Sri Lanka', zoom = 8,  
                   maptype = "terrain",
                   legend="none") + geom_point(aes(x = longitude, y = latitude), size=5, color="red",
                  data = srilankamap)

```

## Addtional Databases

We use absolute and relative city size (population) as a proxy for urbanity.

> * City level data
    + [about 45,000 cities from the R 'maps' package](http://CRAN.R-project.org/package=maps) 
    + [about 48,000 cities from Maxmind Inc.](http://download.maxmind.com/download/geoip/database/LICENSE_WC.txt)
    + [additonal 110,000 cities from geonames.com](http://www.geonames.org/)
    + [458 urban centers from wikipedia](http://en.wikipedia.org/wiki/List_of_urban_areas_by_population)
> * Country level data
    + [World Development Indicators from the World Bank](http://data.worldbank.org/data-catalog/world-development-indicators)
    + [Correlates of War from the COW project](http://www.correlatesofwar.org/)

## Limitations 

 * ``Validity``
    - population an insufficient proxy for urbanity
    - but economic, political etc. data not available open source on city level
    - and population probably the single most important one
  
 * ``Reliability``
    - multiple collection sources over decades with unreproducible methods in unclear administrative environments
 

# Data Cleaning

## Challenges
Within single and across datasets

+---------------+----------------+-----------------------+--------------+
| Issue         | Example        | Detail                | Solution     |
+===============+================+=======================+==============+
| Inconsistency | Spellings      | - "Congo, Kinshasa"   | - RegEx      |
|               |                | - "Congo, Dem. Rep."  | - Hand Coding|
+---------------+----------------+-----------------------+--------------+
| Quality       | Typos          | - "Agfhanistan" vs.   | - RegEx      |
|               |                |                       | - Hand Coding|
|               | Errors         |  "Arabistan"          |              |
+---------------+----------------+-----------------------+--------------+
| Bias          | Underreportings| - Soviet Union: 67 vs.| - Control    |
|               |                |   Russia: >1200       | Variables    |
|               | Definitions    | - Iraq since 2003 vs. |              |
|               |                |   Afghanistan 79-89   |              |
+---------------+----------------+-----------------------+--------------+


## Hand Coding

  * Adjusting City and Country Names
    `````
    X<-gsub("^Teberan","Tehran", X, ignore.case=TRUE)
    X<-gsub("^Teheran","Tehran", X, ignore.case=TRUE)
    X<-gsub("^Teherau","Tehran", X, ignore.case=TRUE)
    X<-gsub("^Tehram","Tehran", X, ignore.case=TRUE)
    `````
* "Reassigning" Cities to Countries

    `````
    GTD$country_txt[GTD$country_txt == "Soviet Union" &
                    GTD$city =="Osh" ] <- "Kyrgyzstan"
    GTD$country_txt[GTD$country_txt == "Soviet Union" &
                    GTD$city =="Riga" ] <- "Latvia"
    GTD$country_txt[GTD$country_txt == "Yugoslavia" &
                    GTD$city =="Bogicevica" ] <- "Albania"
    GTD$country_txt[GTD$country_txt == "Yugoslavia" &
                    GTD$city =="Banjica" ] <- "Serbia"
    `````


# Data Manipulating

## Filling, Adding, Extrapolating

> * ``Geo Referencing`` absolute & relative city position
> * ``Proximity Referencing`` each city by assigning it to its closest Urban Center
> * Establishing ``Relative City Size`` as a share of each countries' largest cityies'total population
> * Estimating ``Past Populations`` using country level data and growth rates
> * Determining ``Cities' Rank`` Size given by the population on a country, regional, and world level
> * Including additional ``Control Variables`` for capitals, largest cities, inter-state war, intra-state war, extra-in war, 
    extra-out war, and coastal megacities

## Merging to Current Dataset

We merge city level, country level, and GTD data together to a reproducible database containing 
114086 observations on 44 variables.

* Merged database contains NA share of 11%
* Considered acceptable
* Potential for further reduction
* We assume systematic sources

------

```{r, echo=FALSE, warning=FALSE, results='asis', message=FALSE, fig.height=6, fig.width=8}

#subset the database
srilankamap <- subset(PreGTD, country_txt=="srilanka" & !is.na(latitude))
srilankamap <- srilankamap[!duplicated(srilankamap$merge),]

qmap('Sri Lanka', zoom = 8,  
                   maptype = "terrain",
                   legend="none") + geom_point(aes(x = longitude, y = latitude, colour=srilankamap$inUC, legend.position="none"), size=5, data = srilankamap) +theme (legend.position="none")

```

------

```{r, echo=FALSE, warning=FALSE, results='asis', message=FALSE, fig.height=6, fig.width=8}

#subset the database
colombomap <- subset(PreGTD, country_txt=="srilanka" & !is.na(latitude))
sum.hum <- aggregate(colombomap$HUMscale, by=list(colombomap$WCUC.city.old), FUN=sum)
max.hum <- aggregate(colombomap$HUMscale, by=list(colombomap$WCUC.city.old), FUN=max)
sum.prop <- aggregate(colombomap$PROPscale, by=list(colombomap$WCUC.city.old), FUN=sum)
colombomap  <- merge(colombomap , sum.hum, by.y=c("Group.1"), by.x=c("WCUC.city.old"), all.x=TRUE)
colombomap  <- merge(colombomap , max.hum, by.y=c("Group.1"), by.x=c("WCUC.city.old"), all.x=TRUE)
colombomap  <- merge(colombomap , sum.prop, by.y=c("Group.1"), by.x=c("WCUC.city.old"), all.x=TRUE)
colombomap["sum.hum"]<-colombomap$x.x
colombomap$sum.hum <- ifelse(colombomap$sum.hum >=1500, 1500, colombomap$sum.hum)
colombomap$sum.hum <- ifelse(colombomap$sum.hum >=1000 & colombomap$sum.hum<=1499, 1000, colombomap$sum.hum)
colombomap$sum.hum <- ifelse(colombomap$sum.hum >=500 & colombomap$sum.hum<=999, 500, colombomap$sum.hum)
colombomap$sum.hum <- ifelse(colombomap$sum.hum >=100 & colombomap$sum.hum<=499, 100, colombomap$sum.hum)
colombomap$sum.hum <- ifelse(colombomap$sum.hum >=10 & colombomap$sum.hum<=99, 50, colombomap$sum.hum)
colombomap$sum.hum <- ifelse(colombomap$sum.hum <=10, 10, colombomap$sum.hum)
colombomap$sum.hum <- as.numeric(colombomap$sum.hum)
colombomap["max.hum"]<-colombomap$x.y
colombomap["sum.prop"]<-colombomap$x
colombomap["lon"]<-colombomap$longitude
colombomap["lat"]<-colombomap$latitude
colombomap$inUC<-as.factor(colombomap$inUC)
colombomap$x <- NULL
colombomap$x.y <- NULL
colombomap$x.x <- NULL 

rm(sum.hum, max.hum, sum.prop)

colombomap <- colombomap[!duplicated(colombomap$merge),]

sum.hum <- as.numeric(colombomap$sum.hum)

qmap('Colombo', zoom = 10,  
              maptype = "satellite",
              legend = "topleft", legend="none") + geom_point(aes(x=lon, y=lat, size=sum.hum, color=inUC), data = colombomap) + scale_size_continuous(range=c(5, 15)) +theme (legend.position="none")

```


# Data Analysis

## Approach

We use a simple linear regression, depending on Relative City Sizes attacked over time for various world regions. 
We control for 

  * Extra-In State War
  * Extra-Out State War
  * Intra State War
  * Inter State War
  * Capitals
  * Target's Potential Urbanity
  * including weightings for human and property damage

## Results

[Regresison Table](https://www.dropbox.com/s/tm9ay9dh7o4izyx/rank.model.per.region.1998bis2013.INTRA.WAR.TEST.html?dl=0)

* There is no general global trend for terrorists moving to urban targets
* Results vary across world regions:
    - there is a trend in the Arab World
    - there is a trend in Southeast Asia
* Civil War changes everything!




# From Here...

-----

+-------+--------------+-----------------+------------------+
|   #   |     City     |     Country     | Attacks (Peace)  |
+=======+==============+=================+==================+
| 1     | Santiago     | Chile           | 1426             |
+-------+--------------+-----------------+------------------+
|   2   |    Belfast   | United Kingdom  | 1187             |
+-------+--------------+-----------------+------------------+
|   3   |    Karachi   |    Pakistan     | 1155             |
+-------+--------------+-----------------+------------------+
|   4   |    Bogota    |    Colombia     | 845              |
+-------+--------------+-----------------+------------------+
|   5   |   Medellin   |    Colombia     | 808              |
+-------+--------------+-----------------+------------------+

------

+-------+--------------+-----------------+
|   #   |     Region   |     Attacks     |
+=======+==============+=================+
|   1   |   S. Asia    |      25854      |
+-------+--------------+-----------------+
|   2   |    MENA      |      25250      |
+-------+--------------+-----------------+
|   3   |  S. America  |      16917      |
+-------+--------------+-----------------+
|   4   |  W. Europe   |      13217      |
+-------+--------------+-----------------+
|   5   |  C. America  |      10158      |
+-------+--------------+-----------------+


------

+----------------+--------------+-----------------+------------------+
| Human Damage   |     City     |     Country     |  Killed+Injured  |
+================+==============+=================+==================+
|   1            |    Baghdad   |      Iraq       |       4345       |
+----------------+--------------+-----------------+------------------+
|   2            |     Lima     |      Peru       |       2163       |
+----------------+--------------+-----------------+------------------+
|   3            |    Karachi   |    Pakistan     |       1879       |
+----------------+--------------+-----------------+------------------+
|   4            |   Belfast    | United Kingdom  |       1706       |
+----------------+--------------+-----------------+------------------+
|   5            | San Salvador |   El Salvador   |       1491       |
+----------------+--------------+-----------------+------------------+

-----

+-------+--------------+-----------------+------------------+
|   #   |     Group    |     Country     |  Total Attacks   |
+=======+==============+=================+==================+
|   1   | Shining Path |      Peru       |       4533       |
+-------+--------------+-----------------+------------------+
|   2   |    FMNLF     |   El Salvador   |       3351       |
+-------+--------------+-----------------+------------------+
|   3   |   Taliban    |   Afghanistan   |       3204       |
+-------+--------------+-----------------+------------------+
|   4   |     IRA      | United Kingdom  |       2673       |
+-------+--------------+-----------------+------------------+
|   5   |     FARC     |   Colombia      |       2228       |
+-------+--------------+-----------------+------------------+



## Outlook

* Still a lot of potential for further cleaning
* More possibilities for including control variables
* Currently only few projects using GTD for analysis
* Our approach seems promising for more research endavours


> * ``First, the Master's Thesis!``

## References